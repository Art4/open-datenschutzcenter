{% extends 'base.html.twig' %}

{% block title %}{{ team.name }}{% endblock %}

{% block body %}


    <div class="row wow fadeIn mt-5">

        <!--Grid column-->
        <div class="col-md-6 mb-4">

            <div class="row">
                <div class="col-md-6 mt-2">
                    <a href="{{ path('vvt') }}">
                        <!-- Card -->
                        <div class="card hoverable btn-green">
                            <!-- Card content -->
                            <div class="card-body">
                                <span class="h3-responsive">{{ vvt|length }}</span>
                                <span>Verarbeitungen</span>
                            </div>

                        </div>
                        {% if kVvt|length > 0 %}
                            {{ include('dashboard/__card.html.twig',{'farbe':'red','title':'Krisitsche VVTs','metrik':kVvt|length}) }}
                        {% endif %}
                        <!-- Card -->
                    </a>
                </div>
                <div class="col-md-6 mt-2">
                    <a href="{{ path('vvt') }}">
                        {{ include('dashboard/__card.html.twig',{'farbe':'btn-green','title':'DSFA','metrik':dsfa|length}) }}
                        {% if openDsfa|length > 0 %}
                            {{ include('dashboard/__card.html.twig',{'farbe':'red','title':'Offene DSFA','metrik':openDsfa|length}) }}
                        {% endif %}
                    </a>
                </div>
                <div class="col-md-6 mt-2">
                    <a href="{{ path('tom') }}">
                        {{ include('dashboard/__card.html.twig',{'farbe':'btn-elegant','title':'TOMs','metrik':tom|length}) }}
                    </a>
                </div>
                <div class="col-md-6 mt-2">
                    <a href="{{ path('kontakt') }}">
                        {{ include('dashboard/__card.html.twig',{'farbe':'','title':'Eingetragene Kontakte','metrik':kontakte|length}) }}
                    </a>
                </div>
                <div class="col-md-6 mt-2">
                    <a href="{{ path('datenweitergabe') }}">
                        {{ include('dashboard/__card.html.twig',{'farbe':'btn-grey','title':'Datenweitergaben','metrik':daten|length}) }}
                    </a>
                </div>
                <div class="col-md-6 mt-2">
                    <a href="{{ path('auftragsverarbeitung') }}">
                        {{ include('dashboard/__card.html.twig',{'farbe':'btn-indigo','title':'Auftragsverarbeitungen','metrik':av|length}) }}
                    </a>
                </div>

            </div>


            <!--Card-->
            <div class="card mt-5">
                <!-- Card header -->
                <div class="card-header text-center">
                    Kritische Vorgänge
                </div>
                <!--Card content-->
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h5>Krisitsche Auditfragen</h5>
                            <ul>
                                {% for a in kAudit %}
                                    <li>
                                        <a href="{{ path('audit_tom_edit', {'tom':a.id}) }}"><img style="width: 17px"
                                                                                                  src="{{ asset('icons/pruefung.svg') }}"> {{ a.createdAt|date('d.m.Y H:i') }}
                                            - {{ a.frage }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h5>Krisitsche VVTs</h5>
                            <ul>
                                {% for v in kVvt %}
                                    <li>
                                        <a href="{{ path('vvt_edit', {'id':v.id}) }}"><img style="width: 17px"
                                                                                           src="{{ asset('icons/prozess.svg') }}"> {{ v.createdAt|date('d.m.Y H:i') }}
                                            - {{ v.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h5>Offene DSFA</h5>
                            <ul>
                                {% for d in openDsfa %}
                                    <li>
                                        <a href="{{ path('vvt_dsfa_edit', {'dsfa':d.id}) }}">{{ d.createdAt|date('d.m.Y H:i') }}
                                            - {{ d.vvt.name }}
                                            ({% if not d.dsb %}Beurteilung DSB fehlt{% else %}Ergebnis fehlt{% endif %}
                                            )</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>


                </div>

            </div>
            <!--/.Card-->

        </div>
        <!--Grid column-->

        <!--Grid column-->
        <div class="col-md-6 mb-4">

            <!--Card-->
            <div class="card">
                <!-- Card header -->
                <div class="card-header text-center">
                    Meine Zuweisungen
                </div>
                <!--Card content-->
                <div class="card-body">
                    {% for a in assign|slice(0, 9)|sort((a, b) => b.createdAt <=> a.createdAt) %}
                        {% if a.activ == 1 %}
                            <a
                                    {% if a.name is defined %}
                                        class="btn btn-green btn-block mt-1"
                                        href="{{ path('vvt_edit',{'id':a.id}) }}"
                                    {% elseif a.frage is defined %}
                                        class="btn btn-cyan btn-block mt-1"
                                        href="{{ path('audit_tom_edit',{'tom':a.id}) }}"
                                    {% endif %}
                            >
                                <div class="row text-left">
                                    <div class="col-md-1">
                                        {% if a.name is defined %}<img style="width: 20px"
                                                                       src="{{ asset('icons/prozess.svg') }}">{% else %}
                                            <img style="width: 20px"
                                                 src="{{ asset('icons/pruefung.svg') }}">{% endif %}
                                    </div>
                                    <div class="col-md-7">
                                        {% if a.name is defined %}{{ a.name }}{% elseif a.frage is defined %}{{ a.frage }}{% endif %}
                                    </div>
                                    <div class="col-md-4">
                                        {{ a.status.name }}
                                    </div>
                                </div>
                            </a>
                        {% endif %}
                    {% endfor %}
                    <a class="btn btn-primary btn-block mt-3" href="{{ path('assign',{'vvt':true,'audit':true}) }}">Alle
                        Zuweisungen anzeigen</a>


                </div>

            </div>
            <!--/.Card-->

            <!--Card-->
            <div class="card mt-3">
                <!-- Card header -->
                <div class="card-header text-center">
                    Letzte Änderungen
                </div>
                <!--Card content-->
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Auditfragen</h5>
                            <hr>
                            <ul>
                                {% for a in audit|slice(0, 5) %}
                                    <a href="{{ path('audit_tom_edit', {'tom':a.id}) }}"><img style="width: 14px"
                                                                                              src="{{ asset('icons/pruefung.svg') }}"> {{ a.frage }}
                                    </a><br>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>Verarbeitungsverzeichnisse</h5>
                            <hr>
                            <ul>
                                {% for v in vvt|slice(0, 5) %}
                                    <img style="width: 14px" src="{{ asset('icons/prozess.svg') }}"> <a
                                        href="{{ path('vvt_edit', {'id':v.id}) }}">{{ v.name }}</a><br>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>


                </div>

            </div>
            <!--/.Card-->
        </div>
    </div>
{% endblock %}

{% block javascripts %}
{% endblock %}
